---
marp: true
title: Marp
paginate: true
style: |
  .red {
    color: red;
  }
  .green {
    color : green;
  }
  .blue {
    color : blue;
  }
---

# 성능

웹 성능은 웹페이지가 로딩되고 작동하는 속도와 효율성을 측정한 것이다.
대규모 웹 애플리케이션에서 최적의 성능을 유지하는 것은 긍정적인 사용자 경험을 보장하는데 매우 중요하다.
애플리케이션의 규모가 커지면 트래픽 증가, 무거운 리소스 사용, 광범위한 기능으로 인해 점점 성능 유지가 어려워지기 때문이다.
<br>
이번 장에서는 성능 최적화에 관한 몇 가지 핵심 개념을 살펴본다.

---

## 브라우저는 어떻게 작동하는가?

### 렌더링

서버 -> 브라우저 ( HTML, CSS -> DOM,CSSOM 생성) -> 렌더링

- 렌더링의 2단계

1. 레이아웃
   - 크기 & 위치
2. 페인트
   - 그리기

---

### 로딩

브라우저는 HTML문서를 받으면 이에 참조된 리소스(ex:이미지,스크립트 등...)을 로딩하기 시작한다.
로딩 프로세스는 특히 리소스가 많을 경우 병목이 될 수 있다.
<br>

- prefetching (미리 가져오기)
- preloading (미리 로딩하기)
- resource hint (리소스 힌트)
  <br>
  이 3가지를 이용해서 브라우저에게 미래에 사용할 리소스에 관한 정보를 제공할 수 있다.

---

## 자바스크립트에서의 비용 이해하기와 줄이기

JS는 모던 웹 개발의 핵심 요소가 되었다.
하지만,
❗️JS를 사용하는 비용은 성능,다운로드 시간,CPU 실행시간 과 관련해 부정적인 영향을 미칠 수 있다.
<br>

### 1. 다운로드 시간(네트워크 전송) 줄이기

    JS 번들 크기 작게 (📱을 위해) 유지 👉 다운로드 속도 개선, 메모리 적게 사용, CPU 비용 ⬇️

---

### 2. 실행 시간 줄이기

메인 스레드가 긴 테스크를 실행하느라 바쁘면 사용자 상호작용은 지연 될 수 있다.

    - 긴 테스크들은 메인 스레드를 점유하므로 작은 테스크로 분할
    - 코드를 분할하고 로드되는 순서의 우선순위를 지정

<br>

### 3. 파싱과 컴파일

지난 몇 년간 JS관련 비용의 가장 주목할 만한 변화는 브라우저의 스크립트 파싱 및 컴파일 속도가 크게 향상 되었다는 점이다.
모던 JS엔진인 V8은 메인 스레드를 중지시키지 않고 JS를 파싱 및 컴파일할 수 있다.
(이전 버전의 크롬은 스크립트 전체를 다운로드한 뒤 파싱을 시작)

---

V8엔진의 [코드 캐싱](https://v8.dev/blog/code-caching-for-devs#code-caching-recap) 최적화도 도움이 된다.

1. 스크립트 처음 요청 (콜드 런)
2. 크롬은 스크립트를 다운로드하고 V8에게 컴파일을 지시 + 스크립트를 브라우저의 디스크 캐시에 저장
3. 스크립트 두번째 요청 (웜 런)
4. 크롬은 요청 받은 파일을 브라우저 캐시에서 꺼내고 V8에게 재컴파일 지시
5. 컴파일된 코드는 직렬화되어 캐싱된 스크립트 파일에 메타데이터로 추가
6. 스크립트 세번째 요청 (핫 런)
7. 크롬은 두 파일을 모두 꺼내고 캐시에서 해당 파일의 메타 데이터를 꺼내 V8에게 전달
8. V8은 메타데이터를 역직렬화하고 컴파일을 건너뛴다.
9. 첫 두 번의 방문이 72시간 안에 발생하면 코드 캐싱을 실행
